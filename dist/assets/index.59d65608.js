import{L as e}from"./vendor.427851ec.js";let t=null,o=null,n=null;const r={},s=["num_dep","code_naf","lib_naf","regime","lib_regime","ippc","seveso","lib_seveso","Seveso","famille_ic"],i={};function c(){t&&t.remove(),t=e.geoJSON(n.features,{filter:function(t,n){const r=t.properties,s=Object.entries(i);if(0==s.length)return!1;const c=t.geometry.coordinates,a=e.latLng(c[1],c[0]);if(!o.getBounds().contains(a))return!1;for(const[e,o]of s)if(r[e]!==o)return!1;return!0},onEachFeature:function(e,t){let o="";e.properties&&(e.properties.nom_ets&&(o+=e.properties.nom_ets),e.properties.url_fiche&&(o+=`<br /><a target="_blank" href=${e.properties.url_fiche}> voir fiche </a>`)),t.bindPopup(o)}}).addTo(o)}!async function(){await async function(){n=await(await fetch("/data/icpe.geo.json")).json()}(),function(){for(const e of s){const t={};for(const o of n.features)t[o.properties[e]]=!0;r[e]=Object.keys(t).sort(),""!==r[e][0]&&r[e].unshift("")}}(),function(){let e="";for(const[t,o]of Object.entries(r)){let n="";for(const e of o)n+=`<option>${e}</option>`;e+=`\n            <fieldset>\n                <label>${t}</label>\n                <select name="${t}">${n}</select>\n            </fieldset>        \n        `}e+="\n        <button class='refresh'>\n            Refresh\n        </button>      \n    ",document.querySelector(".filters").innerHTML=e,document.querySelectorAll("select").forEach((e=>{e.addEventListener("change",(t=>{const o=e.getAttribute("name");i[o]=e.value.trim(),c()}))})),document.querySelector(".refresh").addEventListener("click",(()=>{c()}))}(),o=function(){const t=e.map("mapid").setView([48.393011982751744,-2.6470516079040847],13);return e.tileLayer("https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}",{attribution:'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>',maxZoom:18,id:"mapbox/streets-v11",tileSize:512,zoomOffset:-1,accessToken:"pk.eyJ1IjoieW1lbmFyZC1kZXYiLCJhIjoiY2twZWc3emZtMGxzYTJubzhyZnp6ZHJveSJ9.ub0yDhdRQ-dWyKBs7KR1wQ"}).addTo(t),t}(),c()}();
